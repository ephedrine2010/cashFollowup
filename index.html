<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cash Daily Followup</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <!-- Login Screen -->
        <div id="login-screen" class="login-screen">
            <div class="login-card">
                <h1 class="login-title">Cash Daily Followup</h1>
                <div id="login-form" class="auth-form">
                    <input type="text" id="store-id" placeholder="Store ID" />
                    <input type="text" id="emp-id" placeholder="Emp ID" />
                    <button id="login-btn">Login</button>
                    <button id="signup-btn">Sign Up</button>
                    <button id="test-connection-btn" class="test-btn hidden">Test Connection</button>
                </div>
            </div>
            <div class="login-footer">
                <p>By <a href="https://www.linkedin.com/in/mohamed-shanab-154370132/" target="_blank" rel="noopener noreferrer">M. Shanab</a></p>
            </div>
        </div>

        <!-- Header -->
        <header class="hidden">
            <h1>Cash Daily Followup</h1>
            <div id="auth-section">
                <div id="user-info" class="hidden">
                    <span id="user-email"></span>
                    <button id="logout-btn">Logout</button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main id="main-content" class="hidden">
            <!-- Daily Sales Tracking Section -->
            <section class="card sales-section">
                <!-- Sales Entry Form -->
                <div class="sales-form-container">
                    <div class="sales-form-header">
                        <h2>Add Daily Sales Record</h2>
                        <button type="button" class="start-cash-count-btn" onclick="openStartCashCountDialog()">
                            ðŸ’µ Start Cash Count
                        </button>
                    </div>
                    <form id="sales-form">
                        <div class="form-row">
                            <div class="form-group required" style="grid-column: span 1;">
                                <label for="sales-day-no">Day No.:</label>
                                <input type="number" id="sales-day-no" min="1" required />
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="sales-total">Total Sales:</label>
                                <input type="number" id="sales-total" step="0.01" min="0" required />
                            </div>
                            <div class="form-group">
                                <label for="sales-on-account">On Account:</label>
                                <input type="number" id="sales-on-account" step="0.01" min="0" value="0" />
                            </div>
                            <div class="form-group">
                                <label for="sales-online">Online:</label>
                                <input type="number" id="sales-online" step="0.01" min="0" value="0" />
                            </div>
                            <div class="form-group">
                                <label for="sales-stc">STC:</label>
                                <input type="number" id="sales-stc" step="0.01" min="0" value="0" />
                            </div>
                            <div class="form-group">
                                <label for="sales-rajhi">Rajhi:</label>
                                <input type="number" id="sales-rajhi" step="0.01" min="0" value="0" />
                            </div>
                            <div class="form-group">
                                <label for="sales-gift">Gift:</label>
                                <input type="number" id="sales-gift" step="0.01" min="0" value="0" />
                            </div>
                            <div class="form-group">
                                <label for="sales-tamra">Tamra:</label>
                                <input type="number" id="sales-tamra" step="0.01" min="0" value="0" />
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="sales-mada">Mada:</label>
                                <div class="input-with-btn">
                                    <input type="number" id="sales-mada" step="0.01" min="0" value="0" readonly />
                                    <button type="button" class="add-values-btn" data-field="mada">+</button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="sales-visa">Visa:</label>
                                <div class="input-with-btn">
                                    <input type="number" id="sales-visa" step="0.01" min="0" value="0" readonly />
                                    <button type="button" class="add-values-btn" data-field="visa">+</button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="sales-master">Master:</label>
                                <div class="input-with-btn">
                                    <input type="number" id="sales-master" step="0.01" min="0" value="0" readonly />
                                    <button type="button" class="add-values-btn" data-field="master">+</button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="sales-other">Other:</label>
                                <input type="number" id="sales-other" step="0.01" min="0" value="0" />
                            </div>
                            <div class="form-group">
                                <label for="sales-total-plastic">Total Plastic:</label>
                                <input type="number" id="sales-total-plastic" step="0.01" readonly value="0" />
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="sales-variance">Variance:</label>
                                <input type="number" id="sales-variance" step="0.01" value="0" />
                            </div>
                            <div class="form-group">
                                <label for="sales-total-cash">Total Cash:</label>
                                <input type="number" id="sales-total-cash" step="0.01" readonly value="0" />
                            </div>
                            <div class="form-group">
                                <label for="sales-note">Note:</label>
                                <input type="text" id="sales-note" placeholder="Add note for this day..." maxlength="100" />
                            </div>
                            <div class="form-group">
                                <label>&nbsp;</label>
                                <button type="submit" class="add-sales-record-btn">Add Sales Record</button>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Sales Table -->
                <div class="sales-table-container">
                    <div class="sales-header">
                        <h2>Sales Records</h2>
                        <div class="sales-controls">
                            <button class="action-button download-excel-btn" onclick="openDownloadDialog()" title="Download as Excel">
                                <span class="download-icon">â¬‡</span> Download Excel
                            </button>
                            <div class="year-navigation">
                                <button class="year-nav-btn" id="prev-year-btn" onclick="changeYear(-1)" title="Previous Year">&lt;</button>
                                <div class="year-display" id="year-display">
                                    <span class="year-label">Year:</span>
                                    <span class="year-value" id="current-year">2026</span>
                                </div>
                                <button class="year-nav-btn" id="next-year-btn" onclick="changeYear(1)" title="Next Year">&gt;</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Months Tab -->
                    <div class="months-tab" id="months-tab">
                        <!-- Month buttons will be generated dynamically -->
                    </div>
                    <div class="table-wrapper">
                        <table id="sales-table" class="sales-table">
                            <thead>
                                <tr>
                                    <th class="day-no-column">Day No.</th>
                                    <th>Total Sales</th>
                                    <th>On Account</th>
                                    <th>Online</th>
                                    <th>STC</th>
                                    <th>Rajhi</th>
                                    <th>Gift</th>
                                    <th>Tamra</th>
                                    <th class="plastic-column">Mada</th>
                                    <th class="plastic-column">Visa</th>
                                    <th class="plastic-column">Master</th>
                                    <th class="plastic-column">Other</th>
                                    <th class="total-plastic-column">Total Plastic</th>
                                    <th>Variance</th>
                                    <th class="total-cash-column">Total Cash</th>
                                    <th>Amanco</th>
                                    <th>Actions</th>
                                    <th class="note-column">Note</th>
                                </tr>
                            </thead>
                            <tbody id="sales-table-body">
                                <tr class="empty-row">
                                    <td colspan="17" class="empty-state">No sales records yet. Add your first record above!</td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr class="summary-row">
                                    <td colspan="15" class="summary-label">Total Cash (Unchecked Amanco):</td>
                                    <td id="total-cash-summary" class="summary-value total-cash-column">0.00</td>
                                    <td colspan="2"></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Loading Spinner -->
    <div id="loading" class="loading hidden">
        <div class="spinner"></div>
    </div>

    <!-- Dialog Containers -->
    <div id="values-dialog-container"></div>
    <div id="download-dialog-container"></div>
    <div id="start-cash-count-dialog-container"></div>

    <!-- App Scripts (using ES6 modules) -->
    <script type="module" src="js/firebase-config.js"></script>
    <script type="module" src="js/utils.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/dialogs/dialog-loader.js"></script>
    <script type="module" src="js/dialogs/card-buttons.js"></script>
    <script type="module" src="js/dialogs/add-sales-record.js"></script>
    <script type="module" src="js/sales-display.js"></script>
    <script type="module" src="js/download.js"></script>
    <script type="module" src="js/start-cash-count.js"></script>
    <script type="module" src="js/app.js"></script>
    
</body>
</html>
